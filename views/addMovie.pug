//- Add movie form view
//- Form for creating a new movie entry with validation
//- Author: Kaushalya Satharasinghe (n01718508)

extends layout

block content
  .form-container
    h1 Add New Movie
    p Add a new movie to your collection

    //- Display validation errors if any
    if errors
      each error in errors
        .alert.alert-danger= error.msg

    //- Movie creation form
    form(method="POST", action="/movies/add")
      //- Movie title input
      .form-group
        label(for="name") Movie Title:
        input.form-control(
          type="text", 
          name="name", 
          id="name",
          value=formData ? formData.name : '',
          required,
          placeholder="Enter movie title"
        )
      
      //- Description textarea (minimum 10 characters)
      .form-group
        label(for="description") Description:
        textarea.form-control(
          name="description", 
          id="description",
          rows="4",
          minlength="10",
          required,
          placeholder="Enter movie description (minimum 10 characters)"
        )= formData ? formData.description : ''
        small.form-text Minimum 10 characters
      
      //- Release year input (1900-2025)
      .form-group
        label(for="year") Release Year:
        input.form-control(
          type="text", 
          name="year", 
          id="year",
          pattern="[0-9]{4}",
          value=formData ? formData.year : '',
          required,
          placeholder="e.g. 2024"
        )
        small.form-text Enter a 4-digit year between 1900 and 2025
      
      //- Cover image URL input (optional)
      .form-group
        label(for="coverImage") Cover Image URL:
        input.form-control(
          type="url", 
          name="coverImage", 
          id="coverImage",
          value=formData ? formData.coverImage : '',
          placeholder="Enter image URL",
          autocomplete="off"
        )
 
      //- Genre checkboxes (at least one required)
      .form-group
        label Genres:
        .genres-checkbox
          each genre in availableGenres
            .checkbox-item
              input(
                type="checkbox", 
                name="genres", 
                id=`genre-${genre}`,
                value=genre,
                checked=(formData && formData.genres && formData.genres.includes(genre))
              )
              label(for=`genre-${genre}`)= genre
        small.form-text Select at least one genre
      
      //- Rating input (1-10 scale with 0.1 increments)
      .form-group
        label(for="rating") Rating (1-10):
        input.form-control(
          type="number", 
          name="rating", 
          id="rating",
          min="1",
          max="10",
          step="0.1",
          value=formData ? formData.rating : '7',
          required
        )
        small.form-text Rate from 1 (poor) to 10 (excellent)
      
      //- Form action buttons
      .form-actions
        button.btn.btn-primary(type="submit") 
          span ➕ 
          | Add Movie
        a.btn.btn-secondary(href="/movies") 
          span ↩️ 
          | Cancel